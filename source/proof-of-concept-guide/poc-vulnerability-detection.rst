.. Copyright (C) 2015, Wazuh, Inc.

.. meta::
   :description: Wazuh detects if installed applications have an unpatched CVE in the monitored system. Learn more about this in this PoC.

Vulnerability detection
=======================

Wazuh uses the Vulnerability Detection module to identify vulnerabilities in applications and operating systems running on endpoints.

This use case shows how Wazuh detects unpatched Common Vulnerabilities and Exposures (CVEs) in the monitored endpoint.

For more information on this capability, check the :doc:`vulnerability detection </user-manual/capabilities/vulnerability-detection/index>` section of the documentation.

Infrastructure
--------------

+---------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Endpoint      | Description                                                                                                                                |
+===============+============================================================================================================================================+
| Ubuntu 22.04  | The vulnerability detection module checks for vulnerabilities in the operating system and installed applications in this Linux endpoint.   |
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Windows 11    | The vulnerability detection module checks for vulnerabilities in the operating system and installed applications in this Windows endpoint. |
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------+

Configuration
-------------

The Vulnerability Detection module is enabled by default. You can perform the following steps on the Wazuh server to ensure that the Wazuh Vulnerability Detection module is enabled and properly configured.

#. Open the ``/var/ossec/etc/ossec.conf`` file on the Wazuh server. Check the following settings.

   -  Vulnerability Detection is enabled.

      .. code-block:: xml
         :emphasize-lines: 2

         <vulnerability-detection>
            <enabled>yes</enabled>
            <index-status>yes</index-status>
            <feed-update-interval>60m</feed-update-interval>
         </vulnerability-detection>

   -  The indexer connection is properly configured.

      .. include:: /_templates/installations/manager/configure_indexer_connection.rst

#. If you made changes to the configuration, restart the Wazuh manager.

   .. code-block:: console

      $ sudo systemctl restart wazuh-manager

Vulnerability detection sections
--------------------------------

To access information about vulnerabilities detected in your system, follow these steps:

1. **Navigate to the Thread Intelligence Section**: In the Wazuh dashboard, locate the "Thread Intelligence" section. This is where you'll find insights into potential threats and vulnerabilities.

2. **Find the Vulnerability Detection Module**: Within the Thread Intelligence section, look for the "Vulnerability Detection" module. Click on it to access detailed information about vulnerabilities across all endpoints.

.. thumbnail:: /images/poc/vulnerabilities-section.png
   :title: Detected vulnerability detection section.
   :align: center
   :width: 80%

Dashboard
~~~~~~~~~

This dashboard offers valuable insights into your system's vulnerabilities. It includes:

- **Summary of Top 5 Vulnerabilities**: Quickly identify the most critical vulnerabilities that require immediate attention.

- **Distribution of Vulnerabilities by Severity Levels**: Understand the severity distribution of vulnerabilities, helping you prioritize your response effectively.

- **Most Common Vulnerabilities**: Identify the vulnerabilities that occur most frequently across your system, providing insight into common security risks.

.. thumbnail:: /images/poc/vulnerabilities-dashboard.png
   :title: Vulnerability detection dashboard.
   :align: center
   :width: 80%


Inventory
~~~~~~~~~

The Inventory feature empowers users to search all indexed vulnerabilities using Elastic search capabilities. It offers:

- **Advanced Search Functionality**: Utilize Elastic search to perform detailed searches across all indexed vulnerabilities. With flexible filtering options, you can narrow down your search based on various criteria such as severity, affected software, or vulnerability type.

- **Custom Filters**: Tailor your search using filters of different types, enabling you to refine your results and focus on specific aspects of vulnerabilities that matter most to your organization. Whether it's filtering by CVE ID, affected operating system, or patch status, the Inventory feature provides the flexibility you need to find relevant information efficiently.

- **Detailed Package Information**: Gain access to comprehensive details of vulnerable packages, including version numbers, dependencies, and associated CVEs. This allows you to assess the impact of vulnerabilities accurately and make informed decisions regarding patching and remediation strategies.

.. thumbnail:: /images/poc/vulnerabilities-inventory.png
   :title: Vulnerability detection inventory.
   :align: center
   :width: 80%

Events
~~~~~~

The Event section serves as a comprehensive log of all activity related to vulnerabilities within your system. It offers:

- **Real-time Monitoring**: Stay informed about new vulnerabilities as they occur. The Event section provides real-time updates on newly installed packages provided by syscollector that may introduce security risks to your environment. This enables you to promptly address emerging threats and mitigate potential vulnerabilities before they can be exploited.

- **Visibility into Remediation Actions**: Track the resolution of vulnerabilities. When vulnerabilities are remediated through package upgrades or removals, the Event section records these actions, providing visibility into the remediation process and ensuring accountability for security measures taken.

- **Historical Records**: Access historical data on past events. By maintaining a comprehensive log of all vulnerability-related events, the Event section allows you to analyze trends over time, identify recurring issues, and implement proactive measures to strengthen your system's security posture.

.. note::
   The Event section records events occurring after the initial scan, which establishes a baseline for vulnerability detection. It provides insights into the evolution of vulnerabilities within your system and facilitates proactive security measures.

.. thumbnail:: /images/poc/vulnerabilities-ubuntu-alerts.png
   :title: Vulnerability detection events.
   :align: center
   :width: 80%
