.. Copyright (C) 2015, Wazuh, Inc.

.. meta::
   :description: Wazuh detects if installed applications have an unpatched CVE in the monitored system. Learn more about this in this PoC.

Vulnerability detection
=======================

Wazuh uses the Vulnerability Detection module to identify vulnerabilities in applications and operating systems running on endpoints.

This use case shows how Wazuh detects unpatched Common Vulnerabilities and Exposures (CVEs) in the monitored endpoint.

For more information on this capability, check the :doc:`vulnerability detection </user-manual/capabilities/vulnerability-detection/index>` section of the documentation.

Infrastructure
--------------

+---------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Endpoint      | Description                                                                                                                                |
+===============+============================================================================================================================================+
| Ubuntu 22.04  | The vulnerability detection module checks for vulnerabilities in the operating system and installed applications in this Linux endpoint.   |
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Debian 12     | The vulnerability detection module checks for vulnerabilities in the operating system and installed applications in this Linux endpoint.   |
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------+


Configuration
-------------

The Vulnerability Detection module is enabled by default. You can perform the following steps on the Wazuh server to ensure that the Wazuh Vulnerability Detection module is enabled and properly configured.

#. Open the ``/var/ossec/etc/ossec.conf`` file on the Wazuh server. Check the following settings.

   -  Vulnerability Detection is enabled.

      .. code-block:: xml
         :emphasize-lines: 2

         <vulnerability-detection>
            <enabled>yes</enabled>
            <index-status>yes</index-status>
            <feed-update-interval>60m</feed-update-interval>
         </vulnerability-detection>

   -  The indexer connection is properly configured.

      .. include:: /_templates/installations/manager/configure_indexer_connection.rst

#. If you made changes to the configuration, restart the Wazuh manager.

   .. code-block:: console

      $ sudo systemctl restart wazuh-manager


Test the configuration
----------------------

You donâ€™t have to perform any action. Wazuh detects the vulnerable packages installed in the Ubuntu endpoint automatically. The time it takes to detect vulnerabilities depends on the Syscollector :doc:`interval </user-manual/reference/ossec-conf/wodle-syscollector>` configured in the ``ossec.conf`` file.

#. Install ``vim`` in the Debian endpoint with ``sudo apt install vim -y``.

#. Wait until the syscollector runs a new scan.

#. Delete the package with ``sudo apt purge vim -y``.

Visualize the alerts
--------------------

You can visualize detected vulnerabilities data in the Wazuh dashboard. Go to **Vulnerability Detection** and select **Events** to see a list of all vulnerable packages detected after the first scan.

-  New vulnerability detected:

   .. thumbnail:: /images/poc/vulnerabilities-events-new-vuln.png
      :title: Detected vulnerabilities on Debian. Vulnerable vim package example
      :align: center
      :width: 80%

-  New vulnerability solved:

   .. thumbnail:: /images/poc/vulnerabilities-events-solve-vuln.png
      :title: Solved vulnerabilities on Debian. Vulnerable vim package example
      :align: center
      :width: 80%