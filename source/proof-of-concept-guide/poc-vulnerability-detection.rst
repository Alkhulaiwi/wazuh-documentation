.. Copyright (C) 2015, Wazuh, Inc.

.. meta::
   :description: Wazuh detects if installed applications have an unpatched CVE in the monitored system. Learn more about this in this PoC.

Vulnerability detection
=======================

Wazuh uses the Vulnerability Detection module to identify vulnerabilities in applications and operating systems running on endpoints.

This use case shows how Wazuh detects unpatched Common Vulnerabilities and Exposures (CVEs) in the monitored endpoint.

For more information on this capability, check the :doc:`vulnerability detection </user-manual/capabilities/vulnerability-detection/index>` section of the documentation.

Infrastructure
--------------

+---------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Endpoint      | Description                                                                                                                                |
+===============+============================================================================================================================================+
| Ubuntu 22.04  | The vulnerability detection module checks for vulnerabilities in the operating system and installed applications in this Linux endpoint.   |
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------+


Configuration
-------------

The Vulnerability Detection module is enabled by default. You can perform the following steps on the Wazuh server to ensure that the Wazuh Vulnerability Detection module is enabled and properly configured.

#. Open the ``/var/ossec/etc/ossec.conf`` file on the Wazuh server. Check the following settings.

   -  Vulnerability Detection is enabled.

      .. code-block:: xml
         :emphasize-lines: 2

         <vulnerability-detection>
            <enabled>yes</enabled>
            <index-status>yes</index-status>
            <feed-update-interval>60m</feed-update-interval>
         </vulnerability-detection>

   -  The indexer connection is properly configured.

      .. include:: /_templates/installations/manager/configure_indexer_connection.rst

#. If you made changes to the configuration, restart the Wazuh manager.

   .. code-block:: console

      $ sudo systemctl restart wazuh-manager


Test the configuration
----------------------

You donâ€™t have to perform any action. It performs vulnerability detection scans periodically for applications and operating systems on each monitored endpoint. In this example we use the installed packages on the Ubuntu endpoint.

.. note::
   The time it takes to detect vulnerabilities depends on the syscollector update interval configured in the ``ossec.conf`` file.

Visualize the alerts
--------------------

You can visualize the alert data in the Wazuh dashboard. To do this, go to the Vulnerability Detection module, select Inventory, and see all vulnerable packages. Use the search bar to filter the results.

.. thumbnail:: /images/poc/vulnerabilities-inventory.png
   :title: Detected vulnerabilities on Ubuntu, firefox example
   :align: center
   :width: 80%
