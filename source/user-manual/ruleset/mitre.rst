.. Copyright (C) 2015, Wazuh, Inc.

.. meta::
  :description: Learn more about the enhancement of Wazuh with MITRE, a feature that allows the user to customize the alert information to include specific information related to MITRE ATT&CK techniques.
  
.. _mitre:

Enhancing detection with MITRE ATT&CK framework
===============================================

Created by the MITRE Corporation, MITRE ATT&CK is an acronym that stands for MITRE Adversarial Tactics, Techniques, and Common Knowledge. It is a globally-accessible collection of observed real-world threat actor actions and behavior. The MITRE ATT&CK framework describes 14 tactics and several techniques that security analysts can use to identify attacks in progress. MITRE uses IDs to reference the tactic or technique employed by an adversary.

The Wazuh integration with MITRE ATT&CK framework is provided through an out-of-the-box module on the Wazuh dashboard. It allows users to map alerts generated by Wazuh to specific tactics and techniques. This gives security teams a better understanding of the nature of the threats they are facing and helps them develop effective mitigation strategies.

The Wazuh MITRE ATT&CK module is accessible under the **THREAT DETECTION AND RESPONSE** section of the main page of the Wazuh dashboard. It is shipped with various functionalities to help enhance your threat detection. 

.. thumbnail:: /images/manual/mitre/mitre-att&ck-module.png
  :title: The Wazuh MITRE ATT&CK module
  :alt: The Wazuh MITRE ATT&CK module
  :align: center
  :width: 80%

Intelligence
------------

The **Intelligence** tab includes information about known threat actors or groups that have been observed using particular Tactics, Techniques, and Procedures (TTPs). It also provides any relevant indicators of compromise (IOCs) or mitigations that can be used to detect or prevent attacks leveraging the TTPs. 

Additionally, it contains links to relevant external sources such as MITRE ATT&CK pages, blog posts, and white papers that provide detailed information about each TTP.

.. thumbnail:: /images/manual/mitre/intelligence-tab.png
  :title: Intelligence tab
  :alt: Intelligence tab
  :align: center
  :width: 80%

Framework
---------

The **Framework** tab of the Wazuh MITRE ATT&CK module provides a high-level overview of the tactics and techniques occurring in endpoints monitored by the Wazuh server. This tab enables users to filter and search for specific tactics and techniques, and quickly view which endpoints these events occurred on. You can use this functionality to identify vulnerable areas in your environment.

.. thumbnail:: /images/manual/mitre/framework-tab.png
  :title: Framework tab
  :alt: Framework tab
  :align: center
  :width: 80%

Dashboard
---------

This tab provides an overview of the current state of your infrastructure, with respect to known adversarial Tactics, Techniques, and Procedures (TTPs) in the MITRE ATT&CK framework. The dashboard displays key indicators such as the total number of events, alerts, and a summary of the top 10 TTPs detected within your environment. These indicators can be used to assess the effectiveness of existing security controls and identify areas that may require further attention. Additionally, you can customize the dashboard to display specific metrics that are most relevant to your organization's security posture.

.. thumbnail:: /images/manual/mitre/dashboard-tab.png
  :title: Dashboard tab
  :alt: Dashboard tab
  :align: center
  :width: 80%

Events
------

This tab provides detailed information about each event that has been detected within your environment. It includes their correlation to specific TTPs as defined by the MITRE ATT&CK framework. The information shown in this tab is particularly useful for security teams who need to investigate suspicious activity. It allows them to drill down into the details of individual events and assess their potential impact on an environment. 

You can filter the events based on various criteria such as severity, event type, and detection method, and also sort them by different fields to quickly locate relevant information. Additionally, the tab provides access to additional details such as the full event log message and any related alerts that may have been generated in response to the event.

.. thumbnail:: /images/manual/mitre/events-tab.png
  :title: Events tab
  :alt: Events tab
  :align: center
  :width: 80%

Customization
-------------

The Wazuh MITRE ATT&CK module also supports a range of customization options. For example, users can define custom mappings between Wazuh alerts and specific tactics and techniques, allowing them to tailor the module to their unique needs and requirements.

Example customization
^^^^^^^^^^^^^^^^^^^^^

Wazuh has out-of-the-box detection rules that are mapped against relevant MITRE IDs. However, to use Wazuh with MITRE ATT&CK for threat hunting, you can configure custom rules and assign corresponding MITRE ATT&CK IDs according to the number of techniques involved in the attack.

For this example, we require the following infrastructure:
