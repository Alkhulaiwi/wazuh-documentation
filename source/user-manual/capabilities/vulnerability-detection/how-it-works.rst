.. Copyright (C) 2015, Wazuh, Inc.

.. meta::
   :description: Vulnerability detection is one of the Wazuh capabilities. Learn more about how it works and the repositories it uses.

How it works
============

To detect vulnerabilities, Wazuh agents collect a list of installed applications from monitored endpoints and send it to the Wazuh server. Local SQLite databases in the Wazuh server store this list. The Wazuh server queries the database and cross-correlates this information with the application inventory data of the agent.

The detection process looks for vulnerable packages in the inventory databases. These inventories are unique to each agent. A package is labeled as vulnerable when its version matches those within the affected range of a CVE. Alerts show the results, and the module stores the findings in a per-agent vulnerability inventory. This inventory contains the current state of every agent and includes vulnerabilities that have been detected and not resolved. Users can :doc:`query the inventory </user-manual/capabilities/system-inventory/index>` to check for alerts and vulnerability information.

For Microsoft Windows systems and specific Microsoft products, the Vulnerability Detector has the ``hotfixes`` option in the syscollector settings on the Wazuh agent. Using this option enables the module to detect packages that the user has patched. When the Vulnerability Detector detects a patch, it uses the information provided by Microsoft to decide if the patch has resolved the CVEs. Then, it removes them from the list of vulnerabilities.

Alert generation
----------------

The Vulnerability Detector module generates alerts when it detects new vulnerabilities or when users fix identified vulnerabilities. You can see this workflow in the diagram below.

.. thumbnail:: /images/manual/vuln-detector/vuln-detector-workflow.png
   :title: Vulnerability detector workflow
   :alt: Vulnerability detector workflow
   :align: center
   :width: 80%

.. _vuln_det_compatibility_matrix:

Compatibility matrix
--------------------

The following list shows the operating systems the Vulnerability Detector currently supports.

-  CentOS 5, 6, 7, 8, 9.
-  Red Hat 5, 6, 7, 8, 9.
-  Ubuntu 14 trusty, 16 xenial, 18 bionic, 20 focal, 22 jammy.
-  Debian 10 buster, 11 bullseye, 12 bookworm.
-  Amazon Linux 1, Amazon Linux 2, Amazon Linux 2023.
-  Arch Linux Rolling release.
-  SLES 11 server, SLED 11 desktop, SLES 12 server, SLED 12 desktop, SLES 15 server, SLED 15 desktop.
-  AlmaLinux 8, AlmaLinux 9.
-  Windows XP and later.
-  macOS Sierra and later.

.. note::
   
   Users can extend support for operating systems that aren't listed above by using the :doc:`allow <allow-os>` option.
