.. Copyright (C) 2015, Wazuh, Inc.

.. meta::
  :description: Wazuh provides an automated way of building Wazuh Indexer packages. Learn how to build your own Wazuh Indexer packages in this section of our documentation.
  
.. _create-indexer:

Wazuh Indexer
===

Wazuh provides an automated way of building RPM and DEB Wazuh Indexer packages. keep in mind that to build a package you must run this tool in a system of the wanted package type.

To create an Indexer package follow these steps:

Requirements
^^^^^^^^^^^^

 * docker

Download our wazuh-packages repository from GitHub and go to the indexer directory.

.. code-block:: console

 $ Git clone https://www.github.com/wazuh/wazuh-packages -b |WAZUH_CURRENT|
 $ cd wazuh-packages/stack/indexer

Go into the folder for the type of package to build
.. code-block:: console
 $ cd rpm # For RPM
 $ cd db # For DEB


Execute the ``build_package.sh`` script, with the different options you desire.

.. code-block:: console

  # ./build_package.sh -h

.. code-block:: none
  :class: output

  Usage: ./build_package.sh [OPTIONS]

	    -a, --architecture <arch>  [Optional] Target architecture of the package [amd64].
	    -b, --build-base <yes/no>  [Optional] Build a new base or use a existing one. By default, yes.
	    -r, --revision <rev>   	[Optional] Package revision. By default: 1.
	    -s, --store <path>     	[Optional] Set the destination path of package. By default, an output folder will be created.
	    --reference <ref>      	[Optional] wazuh-packages branch to download SPECs, not used by default.
	    --dont-build-docker    	[Optional] Locally built docker image will be used instead of generating a new one.
	    --future               	[Optional] Build test future package 99.99.0 Used for development purposes.
	    -h, --help             	Show this help.


Packages will be generated by default in an output folder, with the base for the package and a file containing the sha	512 of the package.

Below, you will find some examples of how to build a Wazuh Indexer package.

.. code-block:: console

  # ./build_package.sh -b yes

This will generate the base for the package and then an Indexer package for the default architecture with revision 1.

.. code-block:: console

  # ./build_package.sh -b no -r test

This will generate an Indexer package using an existing base with revision ``test`` for the default architecture.

.. code-block:: console

  # ./build_package.sh -b no -a x86_64

This will generate an Indexer package using an existing base for architecture ``x86_64``.

.. code-block:: console

  # ./build_package.sh -s /path/to/storage/folder

This will generate an Indexer package in a given path instead of the default output path.

.. code-block:: console

  # ./build_package.sh --reference <BRANCH_NAME>

This will generate an Indexer package using the SPECs from the reference branch instead of the current branch.