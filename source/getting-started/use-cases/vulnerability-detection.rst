.. Copyright (C) 2015, Wazuh, Inc.

.. meta::
   :description: The Wazuh Vulnerability Detector module correlates the software inventory data with vulnerability feeds to detect vulnerable software on a monitored endpoint. Find more information in this use case.
  
Vulnerability detection
=======================

Software vulnerabilities are weaknesses in code that can allow attackers to gain access to or manipulate the behavior of an application. Vulnerable software applications are commonly targeted by attackers to compromise endpoints and gain a persistent presence on targeted networks.

Vulnerability detection is the process of identifying these flaws before they are discovered and exploited by attackers. The goal of vulnerability detection is to identify vulnerabilities so that remediation can be carried out to prevent successful attacks.

The :doc:`Wazuh agent </getting-started/components/wazuh-agent>` uses the :doc:`Syscollector </user-manual/capabilities/system-inventory/configuration>` module to collect inventory details from the monitored endpoint. Then, it sends the collected data to the Wazuh server. Within the Wazuh server, the :doc:`Vulnerability Detection </user-manual/capabilities/vulnerability-detection/index>` module correlates the software inventory data with vulnerability content documents to detect vulnerable software on the monitored endpoint.

Wazuh detects vulnerable applications, generating risk reports, through our Cyber Threat Intelligence (CTI) platform. In this platform, we aggregate vulnerability data from diverse sources like operating system vendors and vulnerability databases, consolidating it into a unified, reliable repository. This involves standardizing the varied formats into a common structure. Additionally, we maintain the integrity of our vulnerability data by doing the following.

-  Rectifying format inconsistencies like version errors and typos.
-  Completing missing information.
-  Incorporating new cybersecurity vulnerabilities.

Subsequently, we merge this content, uploading the compiled documents to a cloud server. Finally, we publish these documents to the CTI API.

The :doc:`Vulnerability Detection </user-manual/capabilities/vulnerability-detection/how-it-works>` module supports a variety of operating systems, such as Windows, CentOS, Red Hat Enterprise Linux, Ubuntu, Debian, Amazon Linux, Arch Linux, and macOS operating systems, and applications.

Achieve comprehensive visibility
--------------------------------

The Vulnerability Detector module generates alerts for vulnerabilities discovered on the operating system and applications installed on the monitored endpoint. It correlates the software inventory collected by the Wazuh agent with the vulnerability content documents and displays the alert generated on the Wazuh dashboard. This provides a clear and comprehensive view of vulnerabilities identified in all monitored endpoints, allowing you to view, analyze and fix vulnerabilities.

The vulnerability detection dashboard shows the frequency of occurrences in different categories such as Package name, Agent ID, Vulnerability ID, and Vulnerability severity. This allows analysts to direct their focus appropriately.

.. thumbnail:: /images/getting-started/use-cases/vulnerability-detection/vulnerabilities-inventory.png
   :title: Vulnerabilities inventory
   :alt: Vulnerabilities inventory
   :align: center
   :width: 80%

You can view the alerts generated on the dashboard when new vulnerabilities are discovered.

.. thumbnail:: /images/getting-started/use-cases/vulnerability-detection/vulnerability-alerts.png
   :title: Vulnerability alerts
   :alt: Vulnerability alerts
   :align: center
   :width: 80%

The alerts generated on the dashboard could also be a result of remediation activities. The image below shows alerts generated after an upgrade or an uninstallation of a package resolved a vulnerability.

.. thumbnail:: /images/getting-started/use-cases/vulnerability-detection/resolved-vulnerability-alerts.png
   :title: Resolved vulnerability alerts
   :alt: Resolved vulnerability alerts
   :align: center
   :width: 80%

Obtain actionable intelligence from vulnerability alerts
--------------------------------------------------------

Wazuh vulnerability alerts contain relevant information about the identified vulnerability which can help users understand and decide on remediation steps. You can see an example of a vulnerability detection alert below:

.. thumbnail:: /images/getting-started/use-cases/vulnerability-detection/vulnerability-alert-example.png
   :title: Vulnerability alert example
   :alt: Vulnerability alert example
   :align: center
   :width: 80%

.. code-block:: none
   :emphasize-lines: 11-17, 19-25, 30-32

   {
     "agent": {
       "ip": "192.168.229.142",
       "name": "CentOS",
       "id": "001"
     },
     "manager": {
       "name": "wazuh-server"
     },
     "data": {
       "vulnerability": {
         "severity": "Critical",
         "package": {
           "condition": "Package less than 78.4.1-1.el7_9",
           "name": "firefox",
           "version": "68.10.0-1.el7.centos",
           "architecture": "x86_64"
         },
         "references": [
           "https://bugzilla.mozilla.org/show_bug.cgi?id=1675905",
           "https://www.mozilla.org/security/advisories/mfsa2020-49/",
           "http://packetstormsecurity.com/files/166175/Firefox-MCallGetProperty-Write-Side-Effects-Use-After-Free.html",
           "https://nvd.nist.gov/vuln/detail/CVE-2020-26950",
           "https://access.redhat.com/security/cve/CVE-2020-26950"
         ],
         "cve_version": "4.0",
         "assigner": "security@mozilla.org",
         "published": "2020-12-09",
         "cwe_reference": "CWE-416",
         "title": "CVE-2020-26950 affects firefox",
         "type": "PACKAGE",
         "rationale": "In certain circumstances, the MCallGetProperty opcode can be emitted with unmet assumptions resulting in an exploitable use-after-free condition. This vulnerability affects Firefox < 82.0.3, Firefox ESR < 78.4.1, and Thunderbird < 78.4.2.",
         "advisories_ids": [
           "RHSA-2020:5099",
           "RHSA-2020:5100",
           "RHSA-2020:5104",
           "RHSA-2020:5135",
           "RHSA-2020:5138",
           "RHSA-2020:5139",
         ],
         "cve": "CVE-2020-26950",
         "bugzilla_references": [
           "https://bugzilla.redhat.com/show_bug.cgi?id=1896306"
         ],
         "cvss": {
           "cvss2": {
             "base_score": "9.300000",
             "vector": {
               "integrity_impact": "complete",
               "confidentiality_impact": "complete",
               "availability": "complete",
               "attack_vector": "network",
               "access_complexity": "medium",
               "authentication": "none"
             }
           },
   ...

As you can see above, the alert contains key information about the detected vulnerability. This information includes the CVE information, reference links for further research, and a title that provides a concise description of the vulnerability.

Track vulnerability remediation
-------------------------------

The Wazuh Vulnerability Detector module also allows you to confirm when a vulnerability has been remediated. This feature detects when a patch or software upgrade resolves a previously detected vulnerability. The feature is enabled using the :ref:`hotfixes <wodle_syscollector_hotfixes>` option and is available for Windows endpoints.

.. thumbnail:: /images/getting-started/use-cases/vulnerability-detection/windows-vulnerability-resolved-alert.png
   :title: Windows vulnerability resolved alert
   :alt: Windows vulnerability resolved alert
   :align: center
   :width: 80%

Use vulnerability reports to identify critical security issues
--------------------------------------------------------------

Wazuh provides users with the ability to download a report that contains security events related to discovered and resolved vulnerabilities. This feature allows users to identify endpoints with unresolved vulnerabilities and keep track of remediation activities.

.. thumbnail:: /images/getting-started/use-cases/vulnerability-detection/vulnerability-detection-generate-report.png
   :title: Vulnerability Detection report generation
   :alt: Vulnerability Detection report generation
   :align: center
   :width: 80%
